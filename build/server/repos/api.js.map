{"version":3,"sources":["../../../server/repos/api.js"],"names":["apiHost","getUrl","curry","protocol","host","path","query","format","getAPIEndpoint","Reflect","apply","undefined","split","getSpecificAPIEndpoint","callApi","endpoint","then","response","json","ok","Error","actionToObjects","flow","q"],"mappings":";;;;;;;AAAA;;;;AACA;;;;AACA;;;;;;AAGA;;;AAGA,MAAMA,UAAU,iBAAhB;AACA,MAAMC,SAAS,aAAGC,KAAH,CAAS,CAACC,QAAD,EAAWC,IAAX,EAAiBC,IAAjB,EAAuBC,KAAvB,KAAiC,cAAIC,MAAJ,CAAW;AAClEJ,oBADkE,EACxDC,UADwD,EAClDC,UADkD,EAC5CC;AAD4C,CAAX,CAA1C,CAAf;AAGA,MAAME,iBAAiBC,QAAQC,KAAR,CAAcT,MAAd,EAAsBU,SAAtB,EAAiCX,QAAQY,KAAR,CAAc,KAAd,CAAjC,CAAvB;AACA,MAAMC,yBAAyBL,eAAe,SAAf,CAA/B;;AAEA,SAASM,OAAT,CAAiBC,QAAjB,EAA2B;AACzB,SAAO,yBAAMA,QAAN,EAAgBC,IAAhB,CAAqBC,YACxBA,SAASC,IAAT,GAAgBF,IAAhB,CAAqBE,SAAS,EAAEA,UAAF,EAAQD,kBAAR,EAAT,CAArB,CADG,EAEHD,IAFG,CAEE,UAAwB;AAAA,QAArBE,IAAqB,QAArBA,IAAqB;AAAA,QAAfD,QAAe,QAAfA,QAAe;;AAC7B,QAAI,CAACA,SAASE,EAAd,EAAkB;AAChB,YAAM,IAAIC,KAAJ,CAAW,IAAEF,IAAK,MAAGD,QAAS,GAA9B,CAAN;AACD;AACD,WAAO;AACLA,wBADK;AAELC;AAFK,KAAP;AAID,GAVI,CAAP;AAWD;;AAEM,MAAMG,4CAAkB,aAAGC,IAAH,CAC7BhB,SAAS;AAAI;AACX,SAAO,EAAEiB,GAAGjB,KAAL,EAAP,CADO,CACc;AACtB,CAH4B,EAI7BO,sBAJ6B,EAK7BC,OAL6B,CAAxB","file":"api.js","sourcesContent":["import fetch from 'node-fetch'\nimport fp from 'lodash/fp'\nimport url from 'url'\n\n\n/*\n  Functions that handle building API URLs\n*/\nconst apiHost = 'https://api.com'\nconst getUrl = fp.curry((protocol, host, path, query) => url.format({\n  protocol, host, path, query\n}))\nconst getAPIEndpoint = Reflect.apply(getUrl, undefined, apiHost.split('://'))\nconst getSpecificAPIEndpoint = getAPIEndpoint('/action')\n\nfunction callApi(endpoint) {\n  return fetch(endpoint).then(response =>\n      response.json().then(json => ({ json, response }))\n    ).then(({ json, response }) => {\n      if (!response.ok) {\n        throw new Error(`${json} ${response}`)\n      }\n      return {\n        response,\n        json\n      }\n    })\n}\n\nexport const actionToObjects = fp.flow(\n  query => {   // eslint-disable-line arrow-body-style\n    return { q: query }  // eslint-disable-line id-length\n  },\n  getSpecificAPIEndpoint,\n  callApi\n)\n"]}