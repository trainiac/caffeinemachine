{"version":3,"sources":["../../server/app.js"],"names":["app","settings","webpackConfig","staticSrcPath","loggerLevel","faviconFile","join","console","log","use","json","urlencoded","extended","clientBuildPath","clientSrcPath","output","publicPath","static","htmlFile","req","res","sendFile"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;AACA;;;;;;kBAGe,CAACA,GAAD,EAAMC,QAAN,KAAmB;AAAA,QACxBC,aADwB,GACsBD,QADtB,CACxBC,aADwB;AAAA,QACTC,aADS,GACsBF,QADtB,CACTE,aADS;AAAA,QACMC,WADN,GACsBH,QADtB,CACMG,WADN;;AAEhC,QAAMC,cAAc,eAAKC,IAAL,CAAUH,aAAV,EAAyB,aAAzB,CAApB;AACAI,UAAQC,GAAR,CAAa,wBAAsBH,WAAY,GAA/C;AACAL,MAAIS,GAAJ,CAAQ,4BAAQJ,WAAR,CAAR;;AAEAE,UAAQC,GAAR,CAAa,uBAAqBJ,WAAY,GAA9C;AACAJ,MAAIS,GAAJ,CAAQ,sBAAOL,WAAP,CAAR;;AAEAG,UAAQC,GAAR,CAAY,wBAAZ;AACAR,MAAIS,GAAJ,CAAQ,qBAAWC,IAAX,EAAR;AACAV,MAAIS,GAAJ,CACE,qBAAWE,UAAX,CAAsB;AACpBC,cAAU;AADU,GAAtB,CADF;;AAMAL,UAAQC,GAAR,CAAY,0BAAZ;AACAR,MAAIS,GAAJ,CAAQ,6BAAR;;AAEAF,UAAQC,GAAR,CAAY,2BAAZ;AACAD,UAAQC,GAAR,CAAa,+BAA6BN,cAAcW,eAAgB,GAAxE;AACAN,UAAQC,GAAR,CAAa,6BAA2BN,cAAcY,aAAc,GAApE;AACAP,UAAQC,GAAR,CAAa,gCAA8BN,cAAca,MAAd,CAAqBC,UAAW,GAA3E;AACAhB,MAAIS,GAAJ,CACEP,cAAca,MAAd,CAAqBC,UADvB,EAEE,kBAAQC,MAAR,CAAef,cAAcW,eAA7B,CAFF;AAIA;;;AAGA,QAAMK,WAAW,eAAKZ,IAAL,CAAUH,aAAV,EAAyB,YAAzB,CAAjB;AACAI,UAAQC,GAAR,CAAa,oCAAkCU,QAAS,GAAxD;AACAlB,MAAIS,GAAJ,CAAQ,CAACU,GAAD,EAAMC,GAAN,KAAc;AACpBA,QAAIC,QAAJ,CAAaH,QAAb;AACD,GAFD;;AAIAX,UAAQC,GAAR,CAAY,uBAAZ;AACAR,MAAIS,GAAJ,CAAQ,OAAR;;AAGAF,UAAQC,GAAR,CAAY,4BAAZ;AACAR,MAAIS,GAAJ,CAAQ,qBAAiBT,GAAjB,CAAR;;AAEA,SAAOA,GAAP;AACD,C","file":"app.js","sourcesContent":["import express from 'express'\nimport bodyParser from 'body-parser'\nimport cookieParser from 'cookie-parser'\nimport favicon from 'serve-favicon'\nimport logger from 'morgan'\nimport path from 'path'\n\nimport apiRoutes from './routes/api'\nimport getErrorHandlers from './routes/error'\n\n\nexport default (app, settings) => {\n  const { webpackConfig, staticSrcPath, loggerLevel } = settings\n  const faviconFile = path.join(staticSrcPath, 'favicon.ico')\n  console.log(`configuring favicon ${faviconFile}`)\n  app.use(favicon(faviconFile))\n\n  console.log(`configuring logger ${loggerLevel}`)\n  app.use(logger(loggerLevel))\n\n  console.log('configuring bodyParser')\n  app.use(bodyParser.json())\n  app.use(\n    bodyParser.urlencoded({\n      extended: false\n    })\n  )\n\n  console.log('configuring cookieParser')\n  app.use(cookieParser())\n\n  console.log('configuring static routes')\n  console.log(`webpack config: build path ${webpackConfig.clientBuildPath}`)\n  console.log(`webpack config: src path ${webpackConfig.clientSrcPath}`)\n  console.log(`webpack config: public path ${webpackConfig.output.publicPath}`)\n  app.use(\n    webpackConfig.output.publicPath,\n    express.static(webpackConfig.clientBuildPath)\n  )\n  // the public path is defined in webpack.config.js\n\n\n  const htmlFile = path.join(staticSrcPath, 'index.html')\n  console.log(`configuring html wildcard route ${htmlFile}`)\n  app.use((req, res) => {\n    res.sendFile(htmlFile)\n  })\n\n  console.log('configuring apiRoutes')\n  app.use('/api/', apiRoutes)\n\n\n  console.log('configuring error handlers')\n  app.use(getErrorHandlers(app))\n\n  return app\n}\n\n"]}